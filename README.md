LICENCE
=======
Copyright (c) 2014 Genome Research Ltd.

Author: Cancer Genome Project <cgpit@sanger.ac.uk>

This file is part of cgpBinCounts.

cgpBinCounts is free software: you can redistribute it and/or modify it under
the terms of the GNU Affero General Public License as published by the Free
Software Foundation; either version 3 of the License, or (at your option) any
later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more
details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.

1. The usage of a range of years within a copyright statement contained within
this distribution should be interpreted as being equivalent to a list of years
including the first and last year specified and all consecutive years between
them. For example, a copyright statement that reads ‘Copyright (c) 2005, 2007-
2009, 2011-2012’ should be interpreted as being identical to a statement that
reads ‘Copyright (c) 2005, 2007, 2008, 2009, 2011, 2012’ and a copyright
statement that reads ‘Copyright (c) 2005-2012’ should be interpreted as being
identical to a statement that reads ‘Copyright (c) 2005, 2006, 2007, 2008,
2009, 2010, 2011, 2012’."

cgpBinCounts
============

Generates bin count files as required by PICNIC-NGS and some other tools.

## Reference files

This requires some non-standard reference files

#### cn_bins.csv.gz

Generated by creating normalised bins from a simulated 30x genome (primary chromosomes only).

Generate the simulated genome with the following (requires [PCAP-core](https://github.com/ICGC-TCGA-PanCancer/PCAP-core)):

    samtools faidx fullref.fa 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 X Y > primary.fa

    # -N is (genome-bp * 30) / (length_1 + length_2)
    # e.g. (3,000,000,000 * 30) / (100 + 100) = 450000000
    wgsim -e 0 -N 450000000 -1 100 -2 100 -r 0 -R 0 -X 0 -C primary.fa primary_1.fq primary_2.fq

    # primarily to compact
    fastqtobam checkquality=0 RGID=sim RGLB=sim RGSM=inSilico I=primary_1.fq I=primary_2.fq > primary.bam
    rm -f primary_1.fq primary_2.fq

    # use the full reference to map back to
    # you can kill this when it gets to bam_stats as they aren't needed.
    bwa_mem.pl -o inSilico -r fullref.fa -s inSilico -t 24 primary.bam >& map.log&

    # generate the GC bins using the resulting mapped data.
    gcBinGeneration.pl -i inSilico.bam -o cn_bins -f csv -g fullref.fa

    # compress the output file (or not the code will cope with either)
    gzip cn_bins.csv

#### snp6.csv.gz

This file is based on the SNP6 loci vs GRCh37.  The format is as follows:

    <CHR>,<POS>,<REF>,<rsID>,<alleleA>,<alleleB>,<freq>

* alleleA - The most prevalent allele in the population.
* alleleB - The next most prevalent allele in the population.
* freq - Frequency of alleleA in population.

The tools in this package don't require the ``REF`` or ``rsID`` values to be present (use ``.``).

The file can be gzip compressed or native.
